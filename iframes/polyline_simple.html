<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>点数据展示</title>
    <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no">
    <link rel="stylesheet" href="../css/style.css" />
    <script type="text/javascript" src="http://apps.bdimg.com/libs/jquery/2.1.1/jquery.min.js"></script>
    <script type="text/javascript" src="http://api.map.baidu.com/api?v=2.0&ak=1XjLLEhZhQNUzd93EjU5nOGQ"></script>
</head>
<body>
<div id="map"></div>
<script type="text/javascript" src="../js/lib/Mapv.js"></script>
<script type="text/javascript" src="../js/lib/example.js"></script>
<script type="text/javascript" src="../js/lib/drive.js"></script>
<script type="text/javascript">

    /**
     * @file 示例代码
     */
    
    bmap.centerAndZoom(new BMap.Point(109, 35), 6); // 初始化地图,设置中心点坐标和地图级别

    // 第一步创建mapv示例
    var mapv = new Mapv({
        drawTypeControl: true,
        map: bmap  // 百度地图的map实例
    });
    var line_datas = [];
    //fetchLines();
    
    var layer = new Mapv.Layer({
        zIndex: 1,
        mapv: mapv,
        dataType: 'polyline',
        coordType: 'bd09mc',
        data: [
                {
                    geo:[
                    [13040863.91,3453693.633],
                    [13039153.551,3442150.567],
                    [12886708.995,2854416.281],
                    [12680132.715,2639864.014]
                    ],
                    count:1
                }
            ],
                    
        drawType: 'simple',
        drawOptions: {
            lineWidth: 5,
            strokeStyle: "rgba(0, 0, 255, 0.3)"
        }
    });
    
    function fetchLines(point,cb) {
        RF.request({
            host: 'http://127.0.0.1:8070/',
            path: 'r_api_rain',
            params: {
                lng: point.lng,
                lat: point.lat,
                index: '60',
                level: 3
            },
            suc: function(ret) {
                showLines(ret);
            },
            fai: function(ret) {
                showLines(ret);
            }
        });
    }
    function showLines(ret){
        line_datas = ret;
        var linesegs = ret[lines][0]["segs"];

        var ret1 = testm["points"];
        var polylines = [];
        for(var j=0;j<linesegs.length;j++)
        {
            var linepoints1 = [];
            var seg = linesegs[j];
            var ret = seg["points"];
            for(var i=0;i<ret.length;i++){
       
                var x = ret1[i][0];
                var y = ret1[i][1];
                linepoints1.push(new BMap.Point(x, y) );
            }
            var polyline = new BMap.Polyline(linepoints1, {strokeColor:"blue", strokeWeight:2+i, strokeOpacity:0.5});   //创建折线
            map.addOverlay(polyline);
            //polylines.push(polyline);
        }
    }
</script>
</body>

</html>
